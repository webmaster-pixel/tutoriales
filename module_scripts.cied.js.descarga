/*! Copyright (c) 2025 NUSOFT SAS - www.educa.city. All Rights Reserved. Todos los derechos reservados. Prohibida la copia, almacenamiento o reproducción total o parcial de este recurso. */
 class std_nw_data_model{constructor(e){this.alive = true;this.i_am_data_model = true;};}; class std_nw_obj extends std_nw_data_model{ constructor(e){super(e); if(typeof(e) != 'undefined' && typeof(e._parent) != 'undefined'){this._parent = e._parent;}; this.html = '';this._vh = new views_handler();}; _(selector){var _obj = this;var dom_obj = null;if(!selector){selector = _obj?.dim?.this ?? null;};if(selector){var dom_obj = $(selector);};if(dom_obj == null || dom_obj.length == 0){dom_obj = get_dom_object.call(_obj, selector);};if(dom_obj == null || dom_obj.length == 0){dom_obj = $('#non_existent_dom_object');};return dom_obj;}; render(e){this.html = '';}; assemble(){return true;}; get_html(e){return this.html;}; set_dom_required(){let _obj = this;if(!_obj.dim){_obj.dim = {};};if(!_obj.dom){_obj.dom = {};}; return true;};set_dom(){let _obj = this;if(!_obj.dim){_obj.dim = {};};if(!_obj.dom){_obj.dom = {};};return true;};set_events(){return true;}; inherit_dom(params){if(this._parent?.dom){this.clone_dom(this._parent.dom,params);}else{console.error('Error at inherit_dom(). No parent');};}; clone_dom(src,params) {var _obj = this;var ar_objects  = [];_obj.dom = {};if(typeof(params)!='undefined'){if(typeof(params.ar_objects) != 'undefined'){ar_objects = params.ar_objects;};};$.each(src,function(_dom_obj_name,jquery_properties){var copy = true;if(ar_objects.length > 0){if($.inArray(_dom_obj_name,ar_objects) === -1){copy = false;};};if(copy == true){_obj.dom[_dom_obj_name] = $(jquery_properties.selector);_obj.copy_dom_sub_objects(_obj.dom[_dom_obj_name],jquery_properties);}});};copy_dom_sub_objects(_obj2,ar_properties){var ar_keys = Object.keys(ar_properties);var i = 0;for(i = 0; i < ar_keys.length; i++){var prop_name = ar_keys[i];if(typeof(prop_name) === 'string' && prop_name.startsWith('_') && prop_name != '__proto__'){var prop_content = ar_properties[prop_name];_obj2[prop_name] = $(prop_content.selector);this.copy_dom_sub_objects(_obj2[prop_name],prop_content);}}}}; class std_nw_tool_object extends std_nw_obj{ constructor(e){super(e);this._date_handler = new Date();this.has_changed = false;  this.locked = false;  this.locking = {last_time  : null,timeout : null,disable_timeout : false}; }; set_locking_status_timeout(){var _obj = this;clearTimeout(_obj.locking.timeout);if(_obj.locking.disable_timeout == false){_obj.locking.timeout = null;_obj.locking.timeout = setTimeout(function(){_obj.check_locking_status();},200);};}; check_locking_status(){var _obj = this;var current_time = _obj._date_handler.getTime();var set_timeout_again = false;if(_obj.is_locked()){$('.operation_in_progress').show(); set_timeout_again = true;}else{set_timeout_again = true;$('.operation_in_progress').hide();};if(set_timeout_again == true){_obj.set_locking_status_timeout();};}; lock(){var _obj = this;if(_obj.locked == false){_obj.locking.last_time = _obj._date_handler.getTime();};_obj.locked = true;}; unlock(){var _obj = this;_obj.locked = false;_obj.locking.last_time = null;}; is_locked(){var _obj = this;var dbg = (_obj.locked == true) ? 'tool is locked' : 'tool is unlocked';return (_obj.locked == true);};};function get_nested_selector(selector, obj) { const keys = selector.split('.');return keys.reduce((acc, key) => (acc && acc[key] ? acc[key] : null), obj?.dim);};function get_dom_object(selector) {const obj = this;const resolved_selector = get_nested_selector(selector, obj);if (resolved_selector) {return $(resolved_selector);}else{return $('#non_existent_dom_object');};}; class views_handler{ constructor(e){this.started = true;this.ar_views = {};}; load_views(e){var data = {action : 'get_view_template',result_format : 'json',ar_views : e.ar_views  };$.ajax({url: top._app.root + top.mr_view_handler + '/actions.php',cache: false,data: data,type: "POST",dataType: "json"}).done(function( res ) {if(typeof(res.success) != 'undefined' && res.success == 1){top._vh.ar_views[e.module_name][e.view_name] = res.html;var html = top._vh.ar_views[e.module_name][e.view_name];$.each(e.ar_params,function(k,value){var search = '${'+ k +'};';search = search.replace(';','');  html = html.replace(search,value);});return html;}});}; add_view(e){var _obj = this;if(typeof(_obj.ar_views[e.module_name]) == 'undefined'){_obj.ar_views[e.module_name] = {};};_obj.ar_views[e.module_name][e.view_name] = e.html;}; add_views_batch(e){var _obj =  this;$.each(e,function(i,view){_obj.add_view(view);});}; process(e){var html = '';var _obj = this;let has_loop_tags = false;e.view_name = e.view_name.replaceAll('\\.','__');qt_process = {data_models : 0,loop_tags : 0,subtemplates : 0,params : 0,one_input_tags : 0,process : 0};if(typeof(top._vh) == 'undefined'||typeof(top._vh.ar_views) == 'undefined'||typeof(top._vh.ar_views[e.module_name]) == 'undefined'||typeof(top._vh.ar_views[e.module_name][e.view_name]) == 'undefined'){html = "<div>View " + e.module_name + ":" + e.view_name + " not found </div>";}else{html = top._vh.ar_views[e.module_name][e.view_name];html = _obj.clean_html(html);if(html.indexOf('<subtemplate') != -1){html = _obj.process_subtemplates({html   : html,view_params : e.view_params,view_name : e.view_name});};if(html.indexOf('<repeat') != -1){has_loop_tags = true;};if(has_loop_tags == true){html = _obj.replace_tag_names({html : html,from : ['table','tr','td','select','option'],to : ['table_tmp','tr_tmp','td_tmp','select_tmp','option_tmp']});html = _obj.process_loop_tags({html   : html,view_params : e.view_params,view_name : e.view_name});};if(has_loop_tags == true){html = _obj.replace_tag_names({html : html,from : ['table_tmp','tr_tmp','td_tmp','select_tmp','option_tmp'],to : ['table','tr','td','select','option']});}; html = _obj.process_params({html   : html,view_params : e.view_params,view_name : e.view_name});html = _obj.process_params({html   : html,view_params : e.view_params,view_name : e.view_name});if(html.indexOf('<one_input ') != -1){html = _obj.process_one_input_tags({html   : html,view_params : e.view_params,view_name : e.view_name});};if(html.indexOf('top._dm.ar_') != -1){html = _obj.process_data_models({html   : html,view_params : e.view_params,view_name : e.view_name});html = _obj.process_data_models({html   : html,view_params : e.view_params,view_name : e.view_name});};};return html;}; process_params(x){qt_process.params++;  var _obj = this;let error = false;let html = x.html ?? '';let view_params = x?.view_params ?? null;let parent_node = x?.parent_node ?? '';let qt_stack_calls = x?.qt_stack_calls ?? 0;let limit = 0;html = _obj.clean_html(html);if(html == ''){error = true;};if(error == false){if(qt_stack_calls >= 4){error = true;console.error('views_handler::process_params() qt_stack_calls exceeded ' + qt_stack_calls);};};if(error == false && view_params !== null){$.each(view_params,function(k,one_vpv){if(typeof(one_vpv) == 'object' && k != '_parent' && one_vpv === null){one_vpv = '';};if(typeof(one_vpv) == 'object' && k != '_parent'){   if(one_vpv != null && qt_stack_calls < 4 &&(one_vpv.constructor === Object||one_vpv?.i_am_data_model == true) ){let qt_sub_params = 0;try{qt_sub_params = std_obj_count(one_vpv);}catch(e){qt_sub_params = one_vpv.length;};if(qt_sub_params > 0){ html = _obj.process_params({html   : html,view_name : x.view_name,view_params : one_vpv,parent_node : parent_node + k + '.',qt_stack_calls : qt_stack_calls+1});};};}else{ var search = '${'+ parent_node + k +'};';search = search.replace(';','');limit = 0;while(html.indexOf(search) != -1 && limit < 50){if(one_vpv === null){one_vpv = '';};html = html.replace(search + ';',one_vpv);html = html.replace('[' + search + ']','[' + one_vpv + ']');limit++;}; let regex = /\${tx\.[^}]*}/ig ;var ar_find = html.match(regex);if(ar_find != null){var i = 0;for(i; i < ar_find.length && i < 1000; i++){var one_match = ar_find[i]; let re2 = /(\${tx\.|})/ig ;var one_tid = one_match.replace(re2,'');var text = top._tx.g(one_tid);html = html.replace(one_match + ';',text);html = html.replace(one_match,text);};}; }});};return html;};process_one_input_tags(x){qt_process.one_input_tags++;  let html = x.html;let error = false;let re0 = null;let re1 = null;let re2 = null;let re3 = null;let ar_view_tags= null;let view_info = null;let ar_i = null;     if(html.indexOf('<one_input') == -1){error = true;};if(error == false){re0 = /(?:<view)[^\>]*?(?=\/>)/igs ;re1 = /(?:<one_input).*?(?=<\/one_input>)/igs ;re2 = /\<one_input[^\>]*\>/igm ;re3 = /(\<one_input[^\>]*\>|\<\/one_input\>)/igm ; ar_view_tags = html.match(re0);view_info = {};if(ar_view_tags && ar_view_tags != null){view_info = get_ar_attrs_from_html_tag(ar_view_tags[0].replace('<view',''));};}; if(error == false){ar_i = html.match(re1);if(ar_i == null){error = true;  };};if(error == false){for(let i=0; i < ar_i.length && i < 200; i++){ let one_input = "<one_input" + ar_i[i].replace('<one_input','') + "<\/one_input>"; let oi_tag = one_input.match(re2)[0];let ar_attrs = get_ar_attrs_from_html_tag(oi_tag);let oi_name = ar_attrs.name;let oi_html = '';let oi_text_section = typeof(ar_attrs.text_section) != 'undefined' ? ar_attrs.text_section : view_info.text_section;let input_html = one_input.replace(re3,'').trim().replace('{name};',"name='"+oi_name+"'");let oi = {name : oi_name,label : {text : top._tx.g(oi_text_section + '.' + oi_name)},help : {text : top._tx.g(oi_text_section + '.tooltip_' + oi_name)},input : {html : input_html},z : ''};if(ar_attrs){$.each(ar_attrs,function(i,v){oi[i] = v;});oi_html = view_html({module_name : 'data_models',view_name : 'one_input',view_params : {oi : oi}});};html = html.replace(one_input,oi_html);};};return html;};get_deeper_level(ar,tag_name){let deeper_rl = null;ar.forEach((repeat_tag, index) => { const depth = calculate_tag_depth(repeat_tag, tag_name, 1);if(deeper_rl === null || depth > deeper_rl){deeper_rl = depth;};  });return deeper_rl;};get_ar_to_repeat(x,collection){let ar_to_repeat = null;if(collection != null&&x.view_params != null&&typeof(x.view_params[collection]) != 'undefined'&&std_obj_count(x.view_params[collection]) > 0){ar_to_repeat = x.view_params[collection] ?? null;};return ar_to_repeat;};clean_html(html){html = html.replace(/[\r\n]+/g, '');html = html.replace(/<!--[\s\S]*?-->/g, '');return html;};replace_tag_names(e){let html = e.html;let from = e.from;let to = e.to;from.forEach((f, i) => {let t = to[i];html = html.replaceAll('<' + f, '<' + t);html = html.replaceAll('</' + f, '</' + t);});return html;};process_loop_tags(x){qt_process.loop_tags++; var _obj = this;let html = x?.html ?? null;let error = false;let deeper_rl = null;  let parser = null;  let doc = null;  let ar_repeat_tags = null;  html = _obj.clean_html(html);if(html == ''){error = true;};if(error == false){if(html.indexOf('<repeat ') == -1 || html.indexOf('</repeat>') == -1){error = true;html = html.replaceAll('<repeat ','-repeat-');html = html.replaceAll('</repeat>','-/repeat-');};};if(error == false){ parser = new DOMParser();doc = parser.parseFromString(html, 'text/html');ar_repeat_tags = doc.querySelectorAll('repeat'); if(ar_repeat_tags == null){error = true;};};if(error == false){deeper_rl = _obj.get_deeper_level(ar_repeat_tags,'repeat'); if(deeper_rl == null){error = true;};};if(error == false){ ar_repeat_tags.forEach((repeat_tag, index) => {  const depth = calculate_tag_depth(repeat_tag, 'repeat', 1); let html_replace = '';if(depth != null && depth == deeper_rl){ let collection = repeat_tag?.getAttribute('collection') ?? null;let ar_to_repeat = _obj.get_ar_to_repeat(x,collection);let tag_content = repeat_tag?.innerHTML?.trim();  if(ar_to_repeat != null && tag_content != null && tag_content != ''){$.each(ar_to_repeat,function(k,v){  let vp = (typeof(v) == 'object') ? v : {}; html_replace += _obj.process_params({html : tag_content,view_params : vp,view_name : x.view_name});if(html_replace.indexOf('<one_input') != -1){html_replace = _obj.process_one_input_tags({html   : html_replace,view_params : vp,view_name : x.view_name});}; if(html_replace.indexOf('<repeat') != -1){html_replace = _obj.process_loop_tags({html   : html_replace,view_params : vp,view_name : x.view_name});}});};}; repeat_tag.outerHTML = html_replace;  });html = doc?.documentElement?.outerHTML;}; let qt_stack_calls = x?.qt_stack_calls ?? 0;while(html.indexOf('<repeat') != -1 && qt_stack_calls < 10){ x.html = html;x.qt_stack_calls = qt_stack_calls + 1;html = _obj.process_loop_tags(x);};parser = null;doc = null;return html;}; process_data_models(x){qt_process.data_models++;  let html = x.html;let limit = 0;let regex = /top._dm.ar_([a-z_]*)\[([0-9a-z_]*)\]\.([0-9a-z_]*)/ig ;let ar_find = html.match(regex);if(ar_find != null){let i = 0;for(i; i < ar_find.length; i++){let one_match = ar_find[i];let match_parts = regex.exec(one_match); try{if(match_parts != null && std_obj_count(match_parts) > 0){let ar = match_parts[1];let row_id = match_parts[2];let attr = match_parts[3];let replace = top._dm['ar_' + ar][row_id][attr];limit = 0;while(html.indexOf(one_match) != -1 && limit < 50){ html = html.replace(one_match,replace);limit++;};};}catch(e){let msg = 'Array, row_id or atribute not found in data_models: ' + one_match; }}};return html;}; process_subtemplates(x){qt_process.subtemplates++;  let html = x.html;let re4 = /(\<subtemplate[^\>]*\/>)/igm ;let ar_st = html.match(re4); if(ar_st != null){ $.each(ar_st,function(i,one_match){ let attrs_str = one_match.replace('<subtemplate','').replace('/>','').trim();let ar_attrs = get_ar_attrs_from_html_tag(attrs_str);let view= ar_attrs['view'];let ar_parts = view.split('.');let section = ar_parts[0];let view_name = ar_parts[1];  if(typeof(top._vh.ar_views[section]) != 'undefined'&&typeof(top._vh.ar_views[section][view_name]) != 'undefined'){let limit = 0;let replace = top._vh.ar_views[section][view_name]; while(html.indexOf(one_match) != -1 && limit < 10){ html = html.replace(one_match,replace); }; limit++;}});};return html;};};function view_html(e){var _vh = new views_handler();var html = _vh.process(e);return html;};var qt_process = {data_models : 0,loop_tags : 0,subtemplates : 0,params : 0,one_input_tags : 0,process : 0}; class dm_academic_term extends std_nw_data_model{constructor(x){super(x);this.at_id = typeof(x.at_id) != 'undefined'? x.at_id   : '';this.name = typeof(x.name) != 'undefined'? x.name : '';this.abr = typeof(x.abbreviation) != 'undefined'? x.abbreviation : '';this.start_date = typeof(x.start_date) != 'undefined'? x.start_date : '';this.end_date = typeof(x.end_date) != 'undefined'?x.end_date : '';this.status = typeof(x.status) != 'undefined'? x.status : '';this.visibility = typeof(x.visibility) != 'undefined'? x.visibility : '';};};class dm_at extends dm_academic_term{constructor(x){super(x);};}; class dm_area extends std_nw_data_model{constructor(x){super(x);this.ar_id = x.ar_id ?? '';this.name = x.name ?? '';this.description= x.description ?? null;this.order= x.order ?? null;this.at_id = x.at_id ?? null;this.parent_ar_id = x.parent_area_id ?? null;this.parent_area_id = x.parent_area_id ?? null;this.final_score_format = x.final_score_format ?? null;};}; class dm_area_x_et extends std_nw_data_model{constructor(x){super(x);this.ar_id = typeof(x.ar_id) != 'undefined'?x.ar_id: '';this.ar_et = typeof(x.ar_et) != 'undefined'?x.ar_et: {}}}; class dm_subarea extends std_nw_data_model{constructor(x){super(x);this.sar_id = x.sar_id ?? '';this.ar_id = x.ar_id ?? '';this.lv_id = x.lv_id ?? '';this.mandatory_approval = x.mandatory_approval ?? 1;this.iac = x.influences_academic_performance ?? 1;this.final_score_format = x.final_score_format ?? null;};}; class dm_subarea_x_et extends std_nw_data_model{constructor(x){super(x);this.sar_id = typeof(x.sar_id) != 'undefined'?x.sar_id: '';this.ar_id = typeof(x.ar_id) != 'undefined'?x.ar_id: '';this.ar_et = typeof(x.ar_et) != 'undefined'?x.ar_et: {}}}; class dm_assignment extends std_nw_data_model{constructor(x){super(x);this.a_id = x.a_id ?? '';this.hie_id = x.hie_id ?? '';this.parent_a_id = x.parent_a_id ?? '';this.ma_id = x.ma_id ?? '';this.author_cu_id = x.author_cu_id ?? '';this.c_id = x.c_id ?? '';this.group = x.group ?? '';this.et_id = x.et_id ?? '';this.title = x.title ?? '';this.description = x.description ?? '';this.date = x.date ?? '';this.delivery_date= x.delivery_date ?? '';this.creation_date = x.creation_date ?? '';this.type_id = x.type_id ?? '';this.asg_group = x.assignment_group ?? '';this.influence = x.influence ?? '';this.order = x.order ?? '';this.permissions = x.permissions ?? '';this.weighting_criteria = x.weighting_criteria ?? '';this.homework = x.is_homework ?? '';this.cnv_id = x.cnv_id ?? '';this.color = x.color ?? '';this.gxc_id = x.gxc_id ?? '';};get_link_html(e){return '';};}; class dm_assignment_type extends std_nw_data_model{constructor(x){super(x);this.type_id = x.type_id ? x.type_id  : '';this.author_cu_id = x.author_cu_id ? x.author_cu_id  : '';this.hie_id = x.hie_id ? x.hie_id  : '';this.name = x.name ? x.name  : '';this.description = x.description ? x.description  : '';this.influence = x.influence ? x.influence  : '';};}; class dm_bhv_behavior extends std_nw_data_model{constructor(x){super(x);this.bhv_id = typeof(x.bhv_id) != 'undefined'? x.bhv_id : '';this.cat_id = typeof(x.cat_id) != 'undefined'? x.cat_id   : null;this.type = typeof(x.type) != 'undefined'? x.type  : 1;this.code = typeof(x.code) != 'undefined'? x.code  : '';this.severity = typeof(x.severity) != 'undefined'? x.severity  : 1;this.description = typeof(x.description) != 'undefined'? x.description : '';this.status = typeof(x.status) != 'undefined'? x.status : 1;this.allowed_roles = typeof(x.allowed_roles) != 'undefined'? x.allowed_roles : '';this.ar_allowed_roles = new Array(); if(this.allowed_roles != '' && this.allowed_roles != null){var ar_temp = this.allowed_roles.split('||');$.each(ar_temp,function(i,v){ar_temp[i] = v.replace('|','');});this.ar_allowed_roles = ar_temp;}}}; class dm_bhv_category extends std_nw_data_model{constructor(x){super(x);this.cat_id = typeof(x.cat_id) != 'undefined'? x.cat_id   : null;this.name = typeof(x.name) != 'undefined'? x.name : '';};}; class dm_branch extends std_nw_data_model{constructor(x){super(x);this.parent_b_id = typeof(x.parent_b_id) != 'undefined'? x.parent_b_id : '';this.b_id = typeof(x.b_id) != 'undefined' ? x.b_id   : null;this.bt_id = typeof(x.bt_id) != 'undefined' ? x.bt_id  : 1;this.name = typeof(x.name) != 'undefined' ? x.name : '';};}; class dm_cluster extends std_nw_data_model{constructor(x){super(x);this.cluster_id = typeof(x.cluster_id) != 'undefined'  ? x.cluster_id : '';this.parent_cluster_id = typeof(x.parent_cluster_id) != 'undefined' ? x.parent_cluster_id : '';this.name = typeof(x.name) != 'undefined'  ? x.name : '';};}; class dm_course extends std_nw_data_model{  constructor(x){super(x);var _obj = this;_obj.c_id = x.c_id ?? '';_obj.ar_id = x.ar_id ?? '';_obj.sar_id = x.sar_id ?? '';_obj.name = x.name ?? '';_obj.lv_id = x.lv_id ?? '';_obj.full_name = x.full_name ?? x.name + ' ' + x.lv_id;_obj.color= top.cur_course_color;_obj.assignments_score_format  = x.assignments_score_format ?? (x.asf ?? null);_obj.final_score_format  = x.final_score_format ?? (x.fsf ?? null);_obj.standards_score_format  = x.standards_score_format ?? (x.ssf ?? null);_obj.ev_id  = x.ev_id ?? null;_obj.format  = x.format ?? null;_obj.lev_id  = x.lev_id ?? null;_obj.scores_range__jump_values_each = x.scores_range__jump_values_each ?? (x.sr_jve ?? null);_obj.scores_range__lower_limit  = x.scores_range__lower_limit ?? (x.sr_ll ?? null);_obj.scores_range__upper_limit  = x.scores_range__upper_limit ?? (x.sr_ul ?? null);_obj.use_assignments  = x.use_assignments ?? (x.ua ?? null);_obj.use_comments  = x.use_comments ?? (x.uc ?? null);_obj.use_massive_assignments  = x.use_massive_assignments ?? (x.uma ?? null);_obj.use_standards  = x.use_standards ?? (x.us ?? null);_obj.weighting_criteria  = x.weighting_criteria ?? (x.wc ?? null);_obj.weighting_elements  = x.weighting_elements ?? (x.we ?? null);_obj.weekly_load  = x.weekly_load ?? (x.wl ?? null);_obj.percentage_in_the_area  = x.percentage_in_the_area ?? (x.pita ?? null);_obj.allow_different_standards_among_teachers  = x.allow_different_standards_among_teachers ?? (x.adsat ?? null);top.cur_course_color = (top.cur_course_color >= 9) ?1 : top.cur_course_color+1;};}; class dm_enrollment extends std_nw_data_model{constructor(x){  super(x);this.e_id = typeof(x.e_id) != 'undefined'?x.e_id : '';this.lv_id = typeof(x.lv_id) != 'undefined'?x.lv_id : '';this.group = typeof(x.group) != 'undefined'?x.group : '';this.school_id_card = typeof(x.school_id_card) != 'undefined'?x.school_id_card : '';};}; class dm_evaluation_term extends std_nw_data_model{constructor(x){super(x);this.et_id = typeof(x.et_id) != 'undefined'? x.et_id   : '';this.at_id = typeof(x.at_id) != 'undefined'? x.at_id   : '';this.name = typeof(x.name) != 'undefined'? x.name : '';this.abr = typeof(x.abbreviation) != 'undefined'? x.abbreviation : '';this.number = typeof(x.number) != 'undefined'? x.number : '';this.date_start = typeof(x.start_date) != 'undefined'? x.start_date : '';this.date_end = typeof(x.end_date) != 'undefined'?x.end_date : '';this.status = typeof(x.status) != 'undefined'? x.status : '';this.visibility = typeof(x.visibility) != 'undefined'? x.visibility : '';this.percentage = typeof(x.percentage) != 'undefined'? x.percentage : '';this.is_current = typeof(x.is_current) != 'undefined'? x.is_current : true;this.has_passed = typeof(x.has_passed) != 'undefined'? x.has_passed : false;};};class dm_et extends dm_evaluation_term{constructor(x){super(x);};}; class dm_gxl extends std_nw_data_model{constructor(x){super(x);this.gxl_id = x?.gxl_id ?? null;this.lv_id = x?.lv_id ?? null;this.group = x?.group ?? null;this.b_id = x?.b_id ?? null;this.at_id = x?.at_id ?? null;this.group_manager = x?.group_manager ?? null;this.qt_students = x?.qt_students ?? null;};}; class dm_gxc extends std_nw_data_model{constructor(x){super(x);this.ar_id = x?.ar_id ?? null;this.gxc_id = x?.gxc_id ?? null;this.c_id = x?.c_id ?? null;this.group = x?.group ?? null;this.b_id = x?.b_id ?? null;this.lv_id = x?.lv_id ?? null;this.course_name = x?.course_name ?? null;this.weekly_load = x?.weekly_load ?? null;this.color= top.cur_gxc_color;top.cur_gxc_color = (top.cur_gxc_color >= 9) ? 1 : top.cur_gxc_color+1;}; render_filter_handler(e){var html = '';var decoration = '';var icon = '';var color = '';var c = top._dm.ar_courses[e.c_id];html += " <div id='gxc_"+e.gxc_id+"' class='a_node a_gxc' title='"+c.full_name+" "+e.group+"' ";html += " node_id='"+e.gxc_id+"' ";html += " gxc_id='"+e.gxc_id+"' ";html += " c_id='"+e.c_id+"' ";html += " group='"+e.group+"' ";html += " b_id='"+e.b_id+"' ";html += " lv_id='"+e.lv_id+"' ";html += " style='color:"+color+";'>";html += "<div class='node_name'>"+c.name+"</div>";html += "<div class='et_list'><div>";html += "</div></div>";html += "<span class='lv_id_group r5'>" + c.lv_id + ' ' + e.group + "</span>";html += "<span class='dn'>" + c.lv_id + e.group + "</span>";html += "</div>";this.html = html;return html;};set_dom(){return '';};}; class dm_gxc_x_et extends std_nw_data_model{constructor(x){super(x);this.gxc_id = typeof(x.gxc_id) != 'undefined'?x.gxc_id: '';this.ar_et = typeof(x.ar_et) != 'undefined'?x.ar_et: {}}}; class dm_gce extends std_nw_data_model{constructor(x){super(x);this.gxc_id = typeof(x.gxc_id) != 'undefined'?x.gxc_id: '';this.c_id = typeof(x.c_id) != 'undefined'? x.c_id: '';this.group = typeof(x.group) != 'undefined'? x.group: '';};}; class dm_level extends std_nw_data_model{constructor(x){  super(x);this.lv_id = typeof(x.lv_id) != 'undefined'?x.lv_id: '';this.name = typeof(x.name) != 'undefined'? x.name: '';};}; class dm_school extends std_nw_data_model{constructor(x){super(x);this.school_id = typeof(x.school_id) != 'undefined'? x.school_id   : '';this.name = typeof(x.name) != 'undefined'? x.name : '';this.is_real = typeof(x.is_real) != 'undefined'? x.is_real : '';this.active = typeof(x.active) != 'undefined'? x.active : '';this.city_id = typeof(x.city_id) != 'undefined'? x.city_id : '';this.type = typeof(x.type) != 'undefined'? x.type : '';this.website = typeof(x.website) != 'undefined'? x.website : '';this.subdomain = typeof(x.subdomain) != 'undefined'? x.subdomain : '';this.lang = typeof(x.lang) != 'undefined'? x.lang : '';this.plan = typeof(x.plan) != 'undefined'? x.plan : '';};}; class dm_standard extends std_nw_data_model{constructor(x){super(x);this.st_id = typeof(x.st_id) != 'undefined'? x.st_id : '';this.creation_date = typeof(x.creation_date) != 'undefined'? x.creation_date : '';this.stt_id = typeof(x.stt_id) != 'undefined'? x.stt_id : '';this.sk_id = typeof(x.sk_id) != 'undefined'? x.sk_id : 1;this.c_id = typeof(x.c_id) != 'undefined'? x.c_id : '';this.group = typeof(x.group) != 'undefined'? x.group : '';this.et_id = typeof(x.et_id) != 'undefined'? x.et_id : '';this.title = typeof(x.title) != 'undefined'? x.title : '';this.description = typeof(x.description) != 'undefined'? x.description : '';this.type_id = typeof(x.type_id) != 'undefined'? x.type_id : '';this.influence_in_et = typeof(x.influence_in_et) != 'undefined'? x.influence_in_et : 0;this.mandatory_approval = typeof(x.mandatory_approval) != 'undefined'?x.mandatory_approval : null;};get_link_html(e){return '';};}; class dm_user extends std_nw_data_model{constructor(x){  super(x);this.u_id = typeof(x.u_id) != 'undefined'? x.u_id: '';this.first_name = typeof(x.first_name) != 'undefined'? x.first_name: '';this.last_name = typeof(x.last_name) != 'undefined'? x.last_name: '';this.email = typeof(x.email) != 'undefined'? x.email: '';this.phone_number = typeof(x.phone_number) != 'undefined'? x.phone_number: '';this.mobile_number = typeof(x.mobile_number) != 'undefined'? x.mobile_number: '';this.email = typeof(x.email) != 'undefined'? x.email: '';this.nid = typeof(x.nid) != 'undefined'? x.nid: '';this.user_img = typeof(x.user_img) != 'undefined'? x.user_img: x.nid + '.jpg';};}; class dm_student extends dm_user{constructor(x){  super(x);this.e_id = typeof(x.e_id) != 'undefined'?x.e_id: '';};}; class dm_teacher extends dm_user{constructor(x){  super(x);};}; class dm_group_manager extends dm_user{constructor(x){  super(x);this.assigned_gxl = typeof(x.assigned_gxl) != 'undefined' ? x.assigned_gxl : '';};}; class dm_teaching_load extends std_nw_data_model{constructor(x){  super(x);this.u_id = typeof(x.u_id) != 'undefined'? x.u_id: '';this.gxc_id = typeof(x.gxc_id) != 'undefined'?x.gxc_id: '';this.c_id = typeof(x.c_id) != 'undefined'? x.c_id: '';this.group = typeof(x.group) != 'undefined'? x.group: '';this.name = typeof(x.name) != 'undefined'? x.name: '';this.lv_id = typeof(x.lv_id) != 'undefined'? x.lv_id: '';};}; class dm_zone extends std_nw_data_model{constructor(x){super(x);this.id = typeof(x.id) != 'undefined'? x.id   : null;this.parent_zone_id = typeof(x.parent_zone_id) != 'undefined'? x.parent_zone_id : '';this.esp = typeof(x.esp) != 'undefined'? x.esp  : 1;this.eng = typeof(x.eng) != 'undefined'? x.eng : '';this.status = typeof(x.status) != 'undefined'? x.status : '';this.code = typeof(x.code) != 'undefined'? x.code : '';};}; class dm_report extends std_nw_data_model{constructor(x){super(x);this.report_id = typeof(x.report_id) != 'undefined'? x.report_id   : null;this.permission_id = typeof(x.permission_id) != 'undefined'? x.permission_id  : null;this.name = typeof(x.name) != 'undefined'? x.name : '';this.report = typeof(x.report) != 'undefined'? x.report : '';this.title = typeof(x.title) != 'undefined'? x.title : '';this.notes = typeof(x.notes) != 'undefined'? x.notes : '';this.keywords = typeof(x.keywords) != 'undefined'? x.keywords : '';};}; class dm_reports_group extends std_nw_data_model{constructor(x){super(x);this.group_id = typeof(x.group_id) != 'undefined'? x.group_id  : null;this.name = typeof(x.name) != 'undefined'? x.name : '';this.title = typeof(x.title) != 'undefined'? x.title : '';this.notes = typeof(x.notes) != 'undefined'? x.notes : '';this.keywords = typeof(x.keywords) != 'undefined'? x.keywords : '';};}; class dm_report_rxg extends std_nw_data_model{constructor(x){super(x);this.ixg_id = typeof(x.ixg_id) != 'undefined'? x.ixg_id   : null;this.report_id = typeof(x.report_id) != 'undefined'? x.report_id : null;this.group_id = typeof(x.group_id) != 'undefined'? x.group_id  : null;};}; var cur_course_color = 1;var cur_gxc_color = 1;class data_models_handler{constructor(e){this.ar_object_types = {area_x_et : {object_set : 'area_x_et',dm_class : 'dm_area_x_et'},areas : {object_set : 'areas',dm_class : 'dm_area'},assignments : {object_set : 'assignments',dm_class : 'dm_assignment'},assignment_types : {object_set : 'assignment_types',dm_class : 'dm_assignment_type'},bhv_behaviors : {object_set : 'bhv_behaviors',dm_class : 'dm_bhv_behavior'},bhv_categories : {object_set : 'bhv_categories',dm_class : 'dm_bhv_category'},branches : {object_set : 'branches',dm_class : 'dm_branch'},clusters : {object_set : 'clusters',dm_class : 'dm_cluster'},courses : {object_set : 'courses',dm_class : 'dm_course'},at : {object_set : 'at',dm_class : 'dm_at'},et : {object_set : 'et',dm_class : 'dm_et'},gce : {object_set : 'gce',dm_class : 'dm_gce'},group_managers : {object_set : 'group_managers',dm_class : 'dm_group_manager'},gxc_x_et : {object_set : 'gxc_x_et',dm_class : 'dm_gxc_x_et'},gxl : {object_set : 'gxl',dm_class : 'dm_gxl'},gxc : {object_set : 'gxc',dm_class : 'dm_gxc'},levels : {object_set : 'levels',dm_class : 'dm_level'},reports : {object_set : 'reports',dm_class : 'dm_report'},reports_groups : {object_set : 'reports_groups',dm_class : 'dm_reports_group'},reports_rxg : {object_set : 'reports_rxg',dm_class : 'dm_report_rxg'},schools : {object_set : 'schools',dm_class : 'dm_school'},staff : {object_set : 'staff',dm_class : 'dm_user'},subareas : {object_set : 'subareas',dm_class : 'dm_subarea'},standards : {object_set : 'standards',dm_class : 'dm_standard'},students : {object_set : 'students',dm_class : 'dm_student'},teachers : {object_set : 'teachers',dm_class : 'dm_teacher'},teaching_load : {object_set : 'teaching_load',dm_class : 'dm_teaching_load'},zones : {object_set : 'zones',dm_class : 'dm_zone'}}}; load_json_objects(e){var error = false;var force_reload = (typeof(e.force_reload) != 'undefined') ? e.force_reload : false;if(typeof(e.include) == 'undefined'){error = true;}else{e.include = this.str_replace_all(e.include,'evaluation_terms','et');};if(error == false){if(force_reload == false){var ar_new_ob_to_inc = new Array();if(e.include.indexOf(',') != -1){var ar_ob_to_inc = e.include.split(',');}else{var ar_ob_to_inc = new Array();ar_ob_to_inc[0] = e.include;};var j = 0;var i = 0;for(i = 0; i < ar_ob_to_inc.length; i++){ var array_name = 'ar_' + ar_ob_to_inc[i];if(typeof(top._dm[array_name]) == 'undefined' || std_obj_count(top._dm) == 0){ar_new_ob_to_inc[j] = ar_ob_to_inc[i];j++;};};e.include = ar_new_ob_to_inc.join(',');};if(e.include.trim() == ''){error = true;console.log('Good: All objects already loaded');};};if(error == false){console.log('Continue: Some objects must still be loaded');e.action = 'load_json_objects';this.get_and_process_json_objects(e);};}; get_and_process_json_objects(e){var include = null;var exclude = null;var _obj = this;var action  = 'load_default_json_objects';if(typeof(e) != 'undefined'){include = (typeof(e.include) != 'undefined') ? e.include : null;exclude = (typeof(e.exclude) != 'undefined') ? e.exclude : null;action  = (typeof(e.action) != 'undefined') ? e.action : 'load_default_json_objects';}else{e = {};};var data = {action : action,include : include,exclude : exclude};var url = top._app.root + top.mr_main_frame + '/actions.php';$.ajax({url: url,cache: false,data: data,type: "POST",dataType: "json"}).done(function( res ) {var loaded_data_models = Object.keys(res);var qt_loaded_json_objects = loaded_data_models.length || 0;$.each(top._cache.inputs_options,function(cache_type,cache){if(typeof e.empty_existing_data_models !== 'undefined' && e.empty_existing_data_models === true){delete top._cache.inputs_options[cache_type];}});top._app.loaded_data_models = loaded_data_models;if(typeof(res.success) != 'undefined' && res.success == true){_obj.process_json_objects(res,e);top.json_objects_for_current_user_ready = true;top._dmh?.are_data_models_loaded();}});}; process_json_objects(res,e){var _obj = this;if(typeof(e.empty_existing_data_models) != 'undefined' && e.empty_existing_data_models == true){$.each(_obj.ar_object_types,function(i,ot){if(typeof(res['ar_' + ot.object_set]) != 'undefined'){top._dm['ar_' + ot.object_set] = null;top._dm['ar_' + ot.object_set] = {};}});}; $.each(_obj.ar_object_types,function(i,ot){if(typeof(res['ar_' + ot.object_set]) != 'undefined'&&['gxc_x_et','area_x_et'].indexOf(ot.object_set) == -1){if(typeof(top._dm['ar_' + ot.object_set]) == 'undefined'){top._dm['ar_' + ot.object_set] = {};};if(Object.keys(res['ar_' + ot.object_set]).length > 0){$.each(res['ar_' + ot.object_set], function(o_id,one_obj){eval('top._dm.ar_' + ot.object_set +  '[o_id] = new ' + ot.dm_class + '(one_obj);');});}}});if(typeof(res.ar_gxc_x_et) != 'undefined'){if(typeof(top._dm.ar_gxc_x_et) == 'undefined'){top._dm.ar_gxc_x_et = {};};if(Object.keys(res.ar_gxc_x_et).length > 0){$.each(res.ar_gxc_x_et, function(gxc_id,one_obj){top._dm.ar_gxc_x_et[gxc_id] = new dm_gxc_x_et({gxc_id:gxc_id,ar_et:one_obj});});};};if(typeof(activate_multilevel_grading_books) != 'undefined' && activate_multilevel_grading_books == true){if(typeof(res.ar_area_x_et) != 'undefined'){if(typeof(top._dm.ar_area_x_et) == 'undefined'){top._dm.ar_area_x_et = {};};if(Object.keys(res.ar_area_x_et).length > 0){$.each(res.ar_area_x_et, function(ar_id,one_obj){top._dm.ar_area_x_et[ar_id] = new dm_area_x_et({ar_id:ar_id,ar_et:one_obj});});}}}}; str_replace_all(target, search, replacement) {var search_rx = new RegExp(search, 'g');var new_text = target.replace(search_rx, replacement);return new_text;}; create_object(e,type){var _new_object = null;if(typeof(type) == 'string'){eval("_new_object = new dm_"+type+"(e);")};return _new_object;}; filter(e){var ar = top._dm[e.ar];var ar_res = {};$.each(ar,function(index,record){var matches = true;$.each(e.filter,function(field,value){if(typeof(value != 'undefined') && value != '[all]' && (typeof(record[field]) == 'undefined' || record[field] != value)){matches = false;}});if(matches == true){ar_res[index] = record;}});return ar_res;}; get_object_def(e){var ar = this.ar_object_types;var found = null;e.dm_class ??= 'dm_' + e?.object_type;$.each(ar,function(k,one_ot){if(e.dm_class == one_ot.dm_class||(typeof(e.object_set) != 'undefined' && e.object_set == one_ot.object_set)||(typeof(e.module_name) != 'undefined' && e.module_name == one_ot.object_set)||(typeof(e.module_name_abbr) != 'undefined' && e.module_name_abbr == one_ot.object_set)){found = one_ot;e.object_set ??= one_ot.object_set;e.module_name ??= k;}});return found;}; update_record(e){ var error = false; var _ot = this.get_object_def(e);if(_ot === null){error = true; };if(error == false){var row_id = e?.record?.row_id ?? null;var ar_os = top._dm['ar_' + _ot.object_set] ?? null;if(ar_os == null){console.log('ar_os was not found :' + _ot.object_set);error = true;};};if(error == false){ if(row_id != null){console.log('row_id : ' + row_id);if(typeof(ar_os[row_id]) == 'undefined'){eval("ar_os[row_id] = new " + _ot.dm_class + "(e.record);");}else{$.each(e.record,function(field_name,field_value){eval("ar_os[" + row_id + "]." + field_name + " = '" + field_value + "';");});}}};if(error == false){  $.each(top._cache.inputs_options,function(cache_type,cache){if([e.object_set,e.module_name,e.module_name_abbr].indexOf(cache.object_set) != -1){delete top._cache.inputs_options[cache_type];}}); var s1 = "select.options_were_dynamically_loaded[bind_source='data_models'][bind_source_set='dm.ar_" + _ot.object_set + "']";top._inputs_handler_dm?.reset_select_options({selector : s1}); var s2 = "select.options_must_be_loaded[bind_source='data_models'][bind_source_set='dm.ar_" + _ot.object_set + "']";top._inputs_handler_dm?.init_select_options({selector : s2});};}; remove_records(e){ var error = false;var _ot = this.get_object_def(e);if(_ot === null){error = true; };if(error == false){var ar_os = top._dm['ar_' + _ot.object_set] ?? null;var ar_records = e?.str_records?.split(',') ?? (e?.ar_records ?? []); };if(error == false){if(ar_os == null){error = true; };};if(error == false){$.each(ar_records, function(k,row_id){if(typeof(ar_os[row_id]) != 'undefined'){delete ar_os[row_id];}});}; if(error == false){$.each(top._cache.inputs_options,function(cache_type,cache){if([e.object_set,e.module_name,e.module_name_abbr].indexOf(cache.object_set) != -1){delete top._cache.inputs_options[cache_type];}}); var s1 = "select.options_were_dynamically_loaded[bind_source='data_models'][bind_source_set='dm.ar_" + _ot.object_set + "']";top._inputs_handler_dm?.reset_select_options({selector : s1}); var s2 = "select.options_must_be_loaded[bind_source='data_models'][bind_source_set='dm.ar_" + _ot.object_set + "']";top._inputs_handler_dm?.init_select_options({selector : s2});};}; are_data_models_loaded(e){var are = false;if(top?._app?.loaded_data_models != null&&top?._app?.loaded_data_models?.length > 0&&top?.json_objects_for_current_user_ready == true){$('#loading_data_models').hide();$('#cssmenu').show();are = true;};return are;}; check_if_data_models_are_loaded(e){var _obj = this;if(!_obj.are_data_models_loaded()){top.ui_alert('Espera un momento. Estamos cargando el menú y otras cosas');};}; unload_data_models(e){var _obj = this;top._app.loaded_data_models = null;top.json_objects_for_current_user_ready = false;_obj.disable_menu();}; disable_menu(e){$('#loading_data_models').show();$('#cssmenu').hide();};}; if(typeof(top._vh) == 'undefined'){top._vh = new views_handler();};top._vh.add_views_batch([{"success":true,"module_name":"data_models","view_name":"one_input","html":"\n\u003Cdiv class=\"one_input\" name='${oi.name};' display='${oi.display};'\u003E\n\t\u003Cdiv class=\"label\"\u003E${oi.label.text};\u003C\/div\u003E\n\t\u003Cdiv class=\"input\"\u003E\n\t\t\u003Cspan id=\"span_${oi.name};\"\u003E\n\t\t\t${oi.input.html};\n\t\t\u003C\/span\u003E\n\t\t\u003Cspan valign=\"top\" class=\"cp icn-help help_tooltip ui_tool_tip ui_tool_tip_html\" \n\t\ttitle=\"${oi.help.text};\"\u003E\n\t\t\u003C\/span\u003E\n\t\u003C\/div\u003E\n\t\u003Cdiv class=\"spacer\"\u003E\u003C\/div\u003E\n\u003C\/div\u003E"}]);